# 推送服务 #

## 推送简介 ##

推送服务是利用推送(Push)技术根据用户需要，有目的、按时或及时将用户感兴趣的信息主动发送给用户的服务。一方面服务器端的信息管理与及时推送使得智能终端不用轮询网络，可以达到省电的目的。另一方面，信息流的推送使得用户能够实时的得到通知而不至于错过信息，也省去了手动点开应用拉取刷新内容的麻烦。同时，推送技术通过自动传送信息给用户的方式，可以实现信息的过滤与整合，帮助用户高效率地发掘有价值的信息。

## 功能概述 ##

移动中间件为开发者简化开发和操作，集成了`百度推送`接口，简化了开发者集成的难度，同时提供`服务器端SDK接口`和`客户端SDK接口`；

**推送通知**

向移动端推送展现在系统通知栏的通知消息。

**推送消息**

以透传的方式将开发者自定义的内容发送到客户端。开发者可以预先在客户端设定好规范，进行消息定制化。

**信息统计**

提供推送信息和用户行为的统计。


## 名词解释 ##

**API Key** - 应用标识，终端上的绑定和服务端推送消息时都要用到。

**Secret Key** - 应用私钥，服务端推送消息时用到。

**app id** - 应用ID，就是百度开发者中心的应用基本信息中的应用ID。客户端绑定调用返回值中可获得。

**channel id** - 推送通道ID，通常指一个终端，如一台android系统手机。客户端绑定调用返回值中可获得。

**user id** - 应用的用户ID，一个应用在多个端可以都属于同一用户。user id和channel id配合可以唯一指定一个应用的特定终端。如果应用不是基于百度账户的账户体系，单独用user就通常指定了一个应用的特定终端。客户端绑定调用返回值中可获得。

## 广播消息推送(所有用户)
###描述
开发者向同一个appID应用的所有终端推送消息，不进行任何过滤。
###应用场景举例
企业OA应用，需要向所有员工发送相同信息。

## 单播消息推送(单个用户)
###描述
开发者向应用的特定终端或特定用户推送消息。 特定终端对于应用来说，就是安装了应用的一台具体的设备。 而一个用户可能有多个端，在某些应用场景下，我们希望消息是针对用户的——应用的同一个用户在他的所有终端上都能收到消息，这时候我们就需要向特定用户推送消息。

###解决思路

>向应用的特定终端推送消息

一个channel id指定一个终端，因此在这种需求下，开发者需要通过服务端API，向一个特定channel id推送消息。在推送之前，客户端应用通过绑定接口的返回值获取到channel id，并通过网络等手段发送给开发者，开发者需自行维护channel id。

例如，Android客户端，在调用了startWork之后，自定义消息 receiver将会收到返回值，其中包含了channel id、user id等信息。

>向应用的特定用户推送消息

云推送用user id来表示用户，因此在这种需求下，开发者需要通过服务端API，向一个特定user id推送消息。和channel id获取方式类似，客户端应用通过绑定接口的返回值获取到user id。开发者需要自行维护user id。
###应用场景举例
在线问答应用，用户A用手机发表一个问题，问题的解答并不是实时的。假设在第二天用户B发表了第一个解答，这时需要将答案单独推送给A。
###解决方案
用户A发表问题时，记录问题id及其对应的A的user id（或channel id）。用户B发表解答时，通过服务端API向问题id对应的user id（或channel id）推送解答。

##用户分组的消息推送(Tags)
###描述
开发者向应用的符合特定分类条件的若干用户的集合推送消息。广播是分组推送的特例，它向应用的所有用户（同时也是所有端）推送消息。

###解决思路
云推送通过Tag（标签）这种技术方式来实现用户分组的功能。例如，对于分类信息的应用，一个用户观看了体育栏目，就给该用户打一个Tag——sport。6月的某一天NBA总决赛热火夺冠了，则向sport这个Tag推送一条及时的夺冠新闻。

Tag的设置有两种方法：

>客户端设置

这是最常见的设置方式，因为和用户直接交互的客户端最真实的收集了用户的喜好、习惯等信息。这些信息往往是用户分组的依据。在客户端程序中，一旦用户触发了开发者预先设定的分组条件（如：观看了体育栏目，设置了年龄，团购了电影票等），则调用客户端API进行Tag设置（对应的Tag：sport，80s，movie），如Android端的setTags接口。


>服务端设置

如果开发者自己维护了用户的分组信息，或者存在已发布的还不具备某分组设置功能的终端版本，也可以通过服务端API给特定用户设置Tag，如node.js接口setTag,目前不支持JAVA接口。

广播功能和Tag无关，不需要开发者进行分组的任何操作就已经具备。

###应用场景举例
阅读类应用。对不同阅读喜好的人群推送不同类别的新图书广告。

####解决方案
应用提供喜好设置页面，用户勾选不同的类别，触发对应Tag的设置。或者用户阅读了某个类别的图书，触发对应Tag的设置。在服务端，给特定类别图书的Tag推送新书广告。

## 重要说明 ##
目前单条消息支持**最大 4K **的消息推送功能，兼容文本和二进制消息格式。
如果应用有超过 4K 数据推送的需求，则应用可以在推送的消息里携带资源的 URL 地址，客户端在接收到消息后，主动对这个超过 4K 的数据发起另外一次请求。

云推送服务提供消息暂存、转发和推送的功能，客户端无需保持在线状态及进行反复轮询，消息不会丢失。

单一终端多个应用共享一个服务进程和一条 TCP 长连接，从而有效降低手机的耗电量和数据流量。

**消息类型**

>通知

系统标准样式，包含标题和内容，开发者可以在终端指定用户点击后动作；


>消息

普通模式：只包含消息内容，不含标题；开发者可以预先在客户端设定好规范，进行消息定制化


高级模式：可以指定key和value （无java接口）


**三种接收模式**

> 广播：所有人收到
> 
> 标签（tag）: 设置tag标签的收到
> 
> 单个：针对特定人群


## 使用步骤 ##

### 申请百度开发者账户 ###

登录：http://developer.baidu.com/cloud/push；
如果您有百度账户，请登录；如果没有，请选择注册。

### 创建应用 ###

点击“快速创建应用”，选择“移动客户端”，在应用名称输入框输入您的应用具体名称，然后按“确定”，将会生成三个重要信息：

**应用ID**

**API Key**

**Secret Key**

这三个信息请开发者保留好，是后续进行的基础。

### 推送设置 ###

在“云推送”——推送设置，分别填写Android包名和上传iOS推送证书，iOS推送证书分为开发状态和生产状态，需要使用`苹果开发者帐号`，在苹果开发者网站上获得；

推送SDK分为**服务器端SDK接口**和**客户端SDK接口**；

**客户端SDK接口**


**服务器端SDK接口**：根据其功能不同可分为以下两种：</br>
> 基础功能SDK：可实现开发使用Push服务的基本功能。</br>
> 高级功能SDK：可实现更多Push服务的高级功能。

支持[JAVA](http://./index.html "服务器端推送JAVA接口")（包含基础功能SDK）和[node.js](http://index.html "服务器端推送node.js接口")（包含基础功能SDK和高级功能SDK）两种语言环境

### 参考 ###

更多内容参考http://developer.baidu.com/wiki/index.php?title=docs/cplat/push
